(function(){(function(b){if(typeof define==="function"&&define.amd){return define(["jquery"],b);}else{return b(window.jQuery);}})(function(s){var o,m,x,p,v,t,r,n,w,q,u;q="caret";o=(function(){function a(b){this.$inputor=b;this.domInputor=this.$inputor[0];}a.prototype.setPos=function(b){return this.domInputor;};a.prototype.getIEPosition=function(){return s.noop();};a.prototype.getPosition=function(){return s.noop();};a.prototype.getOldIEPos=function(){var b,c;c=r.selection.createRange();b=r.body.createTextRange();b.moveToElementText(this.domInputor);b.setEndPoint("EndToEnd",c);return b.text.length;};a.prototype.getPos=function(){var d,b,c;if(c=this.range()){d=c.cloneRange();d.selectNodeContents(this.domInputor);d.setEnd(c.endContainer,c.endOffset);b=d.toString().length;d.detach();return b;}else{if(r.selection){return this.getOldIEPos();}}};a.prototype.getOldIEOffset=function(){var c,b;c=r.selection.createRange().duplicate();c.moveStart("character",-1);b=c.getBoundingClientRect();return{height:b.bottom-b.top,left:b.left,top:b.top};};a.prototype.getOffset=function(b){var f,c,e,d;if(w.getSelection&&(e=this.range())){if(e.endOffset-1<0){return null;}f=e.cloneRange();f.setStart(e.endContainer,e.endOffset-1);f.setEnd(e.endContainer,e.endOffset);d=f.getBoundingClientRect();c={height:d.height,left:d.left+d.width,top:d.top};f.detach();}else{if(r.selection){c=this.getOldIEOffset();}}if(c&&!n){c.top+=s(w).scrollTop();c.left+=s(w).scrollLeft();}return c;};a.prototype.range=function(){var b;if(!w.getSelection){return;}b=w.getSelection();if(b.rangeCount>0){return b.getRangeAt(0);}else{return null;}};return a;})();m=(function(){function a(b){this.$inputor=b;this.domInputor=this.$inputor[0];}a.prototype.getIEPos=function(){var e,c,g,d,b,f,h;c=this.domInputor;f=r.selection.createRange();b=0;if(f&&f.parentElement()===c){d=c.value.replace(/\r\n/g,"\n");g=d.length;h=c.createTextRange();h.moveToBookmark(f.getBookmark());e=c.createTextRange();e.collapse(false);if(h.compareEndPoints("StartToEnd",e)>-1){b=g;}else{b=-h.moveStart("character",-g);}}return b;};a.prototype.getPos=function(){if(r.selection){return this.getIEPos();}else{return this.domInputor.selectionStart;}};a.prototype.setPos=function(b){var c,d;c=this.domInputor;if(r.selection){d=c.createTextRange();d.move("character",b);d.select();}else{if(c.setSelectionRange){c.setSelectionRange(b,b);}}return c;};a.prototype.getIEOffset=function(b){var e,d,f,c;d=this.domInputor.createTextRange();b||(b=this.getPos());d.move("character",b);f=d.boundingLeft;c=d.boundingTop;e=d.boundingHeight;return{left:f,top:c,height:e};};a.prototype.getOffset=function(b){var d,c,e;d=this.$inputor;if(r.selection){c=this.getIEOffset(b);c.top+=s(w).scrollTop()+d.scrollTop();c.left+=s(w).scrollLeft()+d.scrollLeft();return c;}else{c=d.offset();e=this.getPosition(b);return c={left:c.left+e.left-d.scrollLeft(),top:c.top+e.top-d.scrollTop(),height:e.height};}};a.prototype.getPosition=function(b){var d,c,e,g,f,h;d=this.$inputor;e=function(i){return i.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />");};if(b===void 0){b=this.getPos();}h=d.val().slice(0,b);g="<span>"+e(h)+"</span>";g+="<span id='caret'>|</span>";f=new x(d);return c=f.create(g).rect();};a.prototype.getIEPosition=function(b){var f,c,e,g,d;e=this.getIEOffset(b);c=this.$inputor.offset();g=e.left-c.left;d=e.top-c.top;f=e.height;return{left:g,top:d,height:f};};return a;})();x=(function(){a.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"];function a(b){this.$inputor=b;}a.prototype.mirrorCss=function(){var c,b=this;c={position:"absolute",left:-9999,top:0,zIndex:-20000,"white-space":"pre-wrap"};s.each(this.css_attr,function(e,d){return c[d]=b.$inputor.css(d);});return c;};a.prototype.create=function(b){this.$mirror=s("<div></div>");this.$mirror.css(this.mirrorCss());this.$mirror.html(b);this.$inputor.after(this.$mirror);return this;};a.prototype.rect=function(){var c,b,d;c=this.$mirror.find("#caret");b=c.position();d={left:b.left,top:b.top,height:c.height()};this.$mirror.remove();return d;};return a;})();p={contentEditable:function(a){return !!(a[0].contentEditable&&a[0].contentEditable==="true");}};t={pos:function(a){if(a||a===0){return this.setPos(a);}else{return this.getPos();}},position:function(a){if(r.selection){return this.getIEPosition(a);}else{return this.getPosition(a);}},offset:function(b){var a,c;c=this.getOffset(b);if(n){a=s(n).offset();c.top+=a.top;c.left+=a.left;}return c;}};r=null;w=null;n=null;u=function(a){n=a;w=a.contentWindow;return r=a.contentDocument||w.document;};v=function(a,c){var e,d;if(s.isPlainObject(c)&&(d=c.iframe)){a.data("caret-iframe",d);return u(d);}else{if(d=a.data("caret-iframe")){return u(d);}else{r=a[0].ownerDocument;w=r.defaultView||r.parentWindow;try{return n=w.frameElement;}catch(b){e=b;}}}};s.fn.caret=function(b){var a;if(typeof b==="object"){v(this,b);return this;}else{if(t[b]){v(this);a=p.contentEditable(this)?new o(this):new m(this);return t[b].apply(a,Array.prototype.slice.call(arguments,1));}else{return s.error("Method "+b+" does not exist on jQuery.caret");}}};s.fn.caret.EditableCaret=o;s.fn.caret.InputCaret=m;s.fn.caret.Utils=p;return s.fn.caret.apis=t;});}).call(this);